function st(a){let t=!1;return new Promise((e,r)=>{Promise.all(a.map(async s=>{const n=await s;!t&&n&&(t=!0,e(n))})).then(()=>{t||e(void 0)})})}function H(a,{removeTrailingSlash:t=!0}={}){if(!a)return;const e=t&&a.endsWith("/")?a.slice(0,-1):a;try{return new URL(e)}catch{return}}function C(a){var t,e;if(!(!a||typeof a!="string"))return a.startsWith("http://")||a.startsWith("https://")?(t=H(a))==null?void 0:t.pathname:a.startsWith("//")?(e=H(`https:${a}`))==null?void 0:e.pathname:a}async function W(a,t,e){const r=await e(()=>{a=0});if(r!==void 0)return r;if(!(a<=0))return await new Promise(s=>{setTimeout(async()=>{const n=await W(a-1,t,e);s(n)},t)})}async function L(a,t,e=0){const r=t.root??document.documentElement,s=t.timeoutMs??1e4;return W(t.lazy===!0?s/50:0,50,()=>{const n=t.all===!0?Array.from(r.querySelectorAll(a)):r.querySelector(a)??void 0;return(t.all?!(n!=null&&n.length):!n)?void 0:n})}const yt={text:Wt,attr:kt,"attr-contain":qt,value:Ut,row:Ft,"bg-image":Vt};function p(a,t){if(a)return vt(a,t,At)}function q(a,t){if(a)return vt(a,t,Et)}function vt(a,t,e){if(!a)return;const r=a.split("||").map(s=>s.trim()).filter(s=>!!s&&s.includes("|"));for(const s of r){const n=zt(s);if(!n)continue;const i=e(t??document.documentElement,n.selector,n.instructions);if(i)return i}}function zt(a){const[t,e]=a.split("|");if(!e)return;const r=(e!=null&&e.startsWith("[")&&e.endsWith("]")?e.substring(1,e.length-1).split(","):[e]).map(s=>{const n=s.indexOf(":"),i=n!==-1;return{extractor:i?s.substring(0,n):s,param:i?s.substring(n+1):""}});return{selector:t||void 0,instructions:r}}function At(a,t,e){if(!t)return nt(a,e);const r=t.split(",");for(const s of r){const n=Array.from(a.querySelectorAll(s));for(const i of n){const l=nt(i,e);if(l)return l}}}function Et(a,t,e){const r=t?Array.from(a.querySelectorAll(t)):[a],s=[];for(const n of r)for(const i of e){const l=yt[i.extractor],o=l(n,i.param);if(o){s.push(o);break}}if(s.length)return s}function nt(a,t){for(const e of t){const r=yt[e.extractor],s=r(a,e.param);if(s)return s}}function Wt(a){return Array.from(a.childNodes).filter(t=>t.nodeType===3).map(t=>E(t.textContent)).filter(Boolean).join(" ").trim()||E(a.textContent)}function kt(a,t){return E(a.getAttribute(t))}function qt(a,t){let e=a.getAttribute(t);if(!e){const r=a.getAttributeNames().find(s=>s.includes(t));r&&(e=a.getAttribute(r))}return E(e)}function Ut(a){return a.value}function Ft(a,t){var s,n,i;if(!t)return;const e=(s=E(a.textContent))==null?void 0:s.toLowerCase(),r=t.toLowerCase();if(!(e!==r&&e!==`${r}:`))return E(((n=a.nextElementSibling)==null?void 0:n.textContent)??((i=a.nextSibling)==null?void 0:i.textContent))}function Vt(a){const t=getComputedStyle(a).backgroundImage;if(!(!t||!t.startsWith("url(")))return t.slice(5,-2)||void 0}function E(a){if(a)return(a==null?void 0:a.replace(/(\n|\t)/g," ").trim())||void 0}var Ht=(a=>(a[a.reading=1]="reading",a[a.paused=2]="paused",a[a.plan=3]="plan",a[a.completed=4]="completed",a[a.dropped=5]="dropped",a[a.deleted=6]="deleted",a))(Ht||{}),Jt=(a=>(a[a.ok=1]="ok",a[a.hidden=2]="hidden",a[a.deleted=3]="deleted",a))(Jt||{}),Gt=(a=>(a[a.aggregator=0]="aggregator",a[a.scanlator=1]="scanlator",a))(Gt||{}),Yt=(a=>(a[a.pending=0]="pending",a[a.completed=1]="completed",a[a.offline=2]="offline",a[a.incompat=3]="incompat",a))(Yt||{}),J=(a=>(a.id="id",a.name="name",a.slug="slug",a))(J||{}),F=(a=>(a.blank="about:blank",a.title="meta.title",a.reader="meta.reader",a))(F||{});const Zt=/(vol(ume)?|season)(\s*|-|\.)(\d+)/i,Kt=/(ch(ap(t(er)?|\.)?|\.)?|^#|episode\.?|capitolo\.?|capitulo\.?|bölüm\.?)(\s*|-)(\d+([_-~,.]\d+)?)/i,Qt=/\d+([_-~,.]\d+)?/,Xt=/[_-~,]/;function A(a){if(!a||!a)return;if(!isNaN(+a))return{chap:+a};const t=a.match(Zt),e=t!=null&&t[0]?a.replace(t[0],"").trim():a,r=e.match(Kt),s=e.match(Qt),n=r==null?void 0:r[6],i=n??(s==null?void 0:s[0]);if(!i)return;const l=+i.replace(Xt,".");if(isNaN(l))return;const o=t==null?void 0:t[4];return{vol:o&&!isNaN(+o)&&a.indexOf(t[0])<a.indexOf(n?r[0]:s[0])?+o:void 0,chap:l}}function U(a){return a.sort((t,e)=>t.vol===void 0||e.vol===void 0?e.chap-t.chap:e.vol-t.vol||e.chap-t.chap),te(a)}function te(a){const t={};for(let e=a.length-1;e>=0;e--){const r=a[e],s=r.lang??"";r.vol!==void 0?t[s]=r.vol:t[s]!==void 0&&(r.inferVol=t[s])}return a}const ee=[{seconds:1,locales:{en:"sec",vi:"giây",tr:"ikinci",es:"segunda"}},{seconds:60,locales:{en:"min",vi:"phút",tr:"dakika"}},{seconds:3600,locales:{en:"hour",vi:"giờ",tr:"saat",fr:"heure",it:"ora",es:"hora"}},{seconds:86400,locales:{en:"day",vi:"ngày",tr:"gün",fr:"jour",it:"giorno",es:"día"}},{seconds:604800,locales:{en:"week",vi:"tuần",tr:"hafta",fr:"semaine",it:"settimana",es:"semana"}},{seconds:2592e3,locales:{en:"month",vi:"tháng",tr:"ay",fr:"mois",it:"mese",es:"mes"}},{seconds:31536e3,locales:{en:"year",vi:"năm",tr:"yil",fr:"ann",it:"anno",es:"año"}}];function it(a,t){const e=a==null?void 0:a.toLowerCase();if(!e)return;const r=Date.now();if(e.includes("now"))return r;if(e.includes("yesterday"))return r-864e5;const s=new Date(e);if(s instanceof Date){const c=s.valueOf();if(!isNaN(c))return s.getHours()===0&&s.getMinutes()===0?Math.min(r,c+432e5):c}const n=ee.find(c=>t&&c.locales[t]&&e.indexOf(c.locales[t])!==-1?!0:e.indexOf(c.locales.en)!==-1);if(!n)return;const i=e.split(" ").filter(Boolean),l=lt(i)??lt(i,["a","an"]);if(!l)return;const o=r-l*n.seconds*1e3;return o>0?o:void 0}function lt(a,t){for(let e=0;e<a.length;e++){const r=a[e];if(t!=null&&t.includes(r))return 1;const s=+r;if(s)return s<0?void 0:s}}function bt(a,t=location.origin){if(!a)return;const e=new URL(a.startsWith("//")?`${location.protocol}${a}`:a,location.origin+location.pathname).toString();return e.startsWith(t)?e.replace(t,""):e}function ot(a,{titleSlug:t,titleId:e}){if(!a)return"/";let r=a.replace("{titleSlug}",t);e&&(r=r.replace("{titleId}",e));const s=r.endsWith("/")?r:r+"/";return s.startsWith("/")?s:"/"+s}function ae(a,t){var o,c,u;const e=[...t],r=[];let s=!1,n=0;const i=Math.min(a.length,100);for(let g=0;g<i;g++){if(n>=10/2){const f=10-r.length;if(f>0){const m=g+f<=a.length?a.slice(g,g+f):e.slice(0,f);r.push(...m)}break}const h=a[g],d=h.id!==void 0,v=e.findIndex(f=>d&&f.id===h.id||f.slug===h.slug||f.name==h.name),b=v===-1?void 0:e.splice(v,1)[0];!b||((o=b.chapters[0])==null?void 0:o.chap)!==((c=h.chapters[0])==null?void 0:c.chap)?(s=!0,r.push({...h,changed:!0})):(n++,r.push(h))}if(!s)return{hasMore:!1,rawReleases:[]};if(r.length<=10)return{hasMore:!!((u=a[a.length-1])!=null&&u.changed),rawReleases:r};const l=[];for(let g=0;g<r.length;g++){const h=r[g];(h.changed||g<10)&&l.push(h)}return{hasMore:t.length<2||t.length-e.length<2,rawReleases:l}}function re(a,t){const e={};return a.forEach(r=>{const s=r.chapters.reduce((n,i)=>{const l=i.lang||t||"";return n[l]||(n[l]=[]),n[l].push(i),n},{});Object.entries(s).forEach(([n,i])=>{const l=`${r.slug}:${n}`;e[l]?(e[l].chapters.push(...i),U(e[l].chapters)):e[l]={...r,lang:n===""?void 0:n,chapters:i}})}),Object.values(e)}var M=(a=>(a.title="title",a.reader="reader",a.releases="releases",a.chapters="chapters",a.search="search",a))(M||{}),se=Object.defineProperty,ne=(a,t,e)=>t in a?se(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,O=(a,t,e)=>(ne(a,typeof t!="symbol"?t+"":t,e),e);class V{constructor(t){O(this,"spec"),O(this,"siteMeta"),O(this,"tags"),O(this,"context"),O(this,"methodsMap",{[M.title]:()=>this.getRawTitleData(),[M.reader]:()=>this.getRawReaderData(),[M.releases]:()=>this.getRawReleasesData(),[M.search]:()=>this.getRawSearchData(),[M.chapters]:()=>this.getRawChaptersData()}),O(this,"normalizedTagsMap"),this.spec=t.spec,this.siteMeta=t.siteMeta,this.tags=t.tags,this.context=t.context}async getRawSearchData(){throw new Error("Unimplemented")}async getRawPageByType(t,e=!1){const r=await this.methodsMap[t](),s=!r&&le(this.spec);if(e&&!r&&!s)return;const n=location.origin+location.pathname;return{type:t,is404:s,specId:this.spec.id,siteName:p(this.spec.name),url:n,data:r,spec:this.spec,context:this.context}}parseReaderSlug(t,e,r){let s=e;if(s[0]!=="/"&&s.includes("/"))try{s=new URL(e,location.href).pathname}catch{}const n=s.endsWith("/")?s.slice(0,-1):s;if(t.includes("{")){const i=t.split("/").filter(Boolean),l=n.split("/").filter(Boolean);if(i.length<l.length){const o=l[i.indexOf("{lang}")],c=l[i.indexOf("{titleId}")],u=l[i.indexOf("{titleSlug}")],g=t.replace("{lang}",o).replace("{titleId}",c).replace("{titleSlug}",u);if(n.startsWith(g))return{basePath:g,lang:o.toLowerCase(),titleId:c,titleSlug:u,slug:n.replace(g,"")}}}else if(n.startsWith(t))return{basePath:t,slug:n.replace(t,"")};return{basePath:"",slug:n[0]==="/"?n.substring(1):n}}parseTitleSlug(t){if(typeof t!="string")return{};const e=C(t),r=e==null?void 0:e.split("/").filter(Boolean);if(!(r!=null&&r.length))return{};const s=this.siteMeta.titleBase.split("/").filter(Boolean),n=s.indexOf("{slug}");return(n===-1?r.length-s.length>=1:r.length===s.length)?{id:r[s.indexOf("{id}")],slug:n===-1?r.slice(s.length).join("/"):r[n]}:{slug:e}}finalizeRawReleasesData(t){var s,n,i;const e=(n=(s=this.spec.releases)==null?void 0:s.title)!=null&&n.lang?this.siteMeta.defaultLang:void 0,r=re(t.rawReleases,e);if(r.length)return(i=this.context)!=null&&i.oldRawReleases?ae(r,this.context.oldRawReleases):{rawReleases:r,hasMore:!0}}getTagIdsFromNames(t){if(!(t!=null&&t.length))return;const e=this.normalizedTagsMap??(this.normalizedTagsMap=ie(this.tags)),r=t.map(s=>e[G(s)]).filter(Boolean);return r.length===0?void 0:Array.from(new Set(r)).sort((s,n)=>s-n)}}O(V,"specId"),O(V,"siteId");function ie(a){const t={};return a.forEach(({id:e,name:r,altNames:s})=>{t[G(r)]=e,s&&s.forEach(n=>{t[G(n)]=e})}),t}function G(a){const t=a.toLowerCase().replaceAll(" ","").replaceAll("-","");return t[t.length-1]==="s"?t.substring(0,t.length-1):t}function le(a){return a[404]&&document.querySelector(a[404])?!0:document.title.toLowerCase().includes("not found")}class x extends V{async getRawReleasesData(){var i,l;if(!((l=(i=this.spec)==null?void 0:i.releases)!=null&&l.title))return;const{chapter:t,...e}=this.spec.releases.title,r=await L(e.sel,{lazy:!0,all:!0});if(!(r!=null&&r.length))return;const s=r.slice(0,100).map(o=>{var d;const c=p(e.url,o),u=C(c),g=p(e.name,o),h=p(e.at,o);if(!(!u||!g))return{titleEl:o,id:p(e.id,o),path:u,name:g,lang:(d=p(e.lang,o))==null?void 0:d.toLowerCase(),at:it(h,this.siteMeta.defaultLang)}}).filter(Boolean);if(!s.length)return;const n=[];return await Promise.all(s.map(async o=>{const{path:c,titleEl:u,lang:g,at:h,...d}=o,{id:v,slug:b}=this.parseTitleSlug(c);if(!b)return;const f=d.id||v,m=await this.getChapters(t,{root:u,titleId:f,titleSlug:b})??[];m.length&&n.push({slug:b,chapters:g||h?m.map(y=>({...y,elIndex:void 0,lang:y.lang??g,ts:y.ts??h})):m,...d,id:f})})),this.finalizeRawReleasesData({rawReleases:n})}getRawTitleData(){return this.getTitleData(this.spec.title)}async getTitleData(t){var u;if(!t||(t.sel||t.lazy)&&!await L(t.sel??t.name,{lazy:!!t.lazy}))return;const e=p(t.name);if(!e)return;const{id:r,slug:s}=this.parseTitleSlug(location.pathname);if(!s)return;let n=q(t.tags)??[];n.length===1&&(n=n[0].split(",").map(g=>g.trim()).filter(Boolean));const i=p(t.type),l=(u=q(t.langs))==null?void 0:u.map(g=>g.toLowerCase()),o=r||p(t.id),c=await this.getChapters(t.chapter,{lazy:!0,titleId:o,titleSlug:s})??[];return{id:o||p(t.id),url:location.origin+location.pathname,slug:s,name:e,langs:l!=null&&l.length?l:t.langs&&this.siteMeta.defaultLang?[this.siteMeta.defaultLang]:void 0,tags:this.getTagIdsFromNames([...n??[],...i?[i]:[]]),chapters:c,img:t.img?await this.getValidImgSrc(t.img):void 0,firstUrl:this.getFirstChapterUrl()}}getFirstChapterUrl(){var e;const t=p((e=this.spec.title)==null?void 0:e.first);if(t){if(t.startsWith("http"))return t;try{return new URL(t,location.href).href}catch{return}}}getValidImgSrc(t){return W(33,30,()=>{const e=p(t);return e&&!e.startsWith("data:")?e.split(" ")[0]:void 0})}async getRawReaderData(){var T,D,w,S,$,N,k;const{spec:t,siteMeta:e}=this;if(!(t!=null&&t.reader)||t.generic&&!await x.isReaderPage(t.reader))return;const r=t.reader.content;if(!(!r||await x.verifyImgsCotainer(r)))return;const s=t.reader.title,n=document.querySelector(s.sel);if(!n)return;const i=p(s.name,n),l=p(s.url,n),{slug:o,id:c}=this.parseTitleSlug(l),u=p(s.img,n);if(!i||!l||!o)return;const g=c||p(s.id),h=!!((T=this.context)!=null&&T.disableLazyChapters),d=!!((D=this.context)!=null&&D.includeHiddenChapters),v=await this.getChapters((w=t.reader)==null?void 0:w.chapter,{titleId:g,titleSlug:o,lazy:d||!h,includeHiddenChapters:d,timeoutMs:d?3e3:12e4})??[],b=(S=p(t.reader.label))==null?void 0:S.toLowerCase().replace(i.toLowerCase(),"");if(!b)return;const{vol:f,chap:m=0}=A(b)||{},{slug:y,basePath:P,lang:R,titleId:B}=this.parseReaderSlug(ot(e.readerBase,{titleId:g,titleSlug:o}),location.pathname,location.href);return this.finalizeRawReaderData({vol:f,chap:m,lang:R??(($=p(t.reader.lang))==null?void 0:$.toLowerCase())??(t.reader.lang?this.siteMeta.defaultLang:void 0),slug:y,basePath:P,imgs:r?void 0:q(t.reader.imgs),title:{id:g||B||p(s.id),url:l,slug:o,name:i,langs:R?[R]:void 0,img:bt(u),chapters:v,hasMoreChapters:h&&!v.length&&!!((N=t.reader)!=null&&N.chapter)&&!((k=t.reader)!=null&&k.chapter.trigger)}},{prevSlug:this.findNeighborChapter({sel:t.reader.prev,basePath:P}),nextSlug:this.findNeighborChapter({sel:t.reader.next,basePath:P})})}async getRawChaptersData(){var o,c,u,g,h;const t=this.siteMeta.chapters;if(t===F.blank)return;const e=t===F.reader,r=!t||t===F.title,s=e?(o=await this.getRawReaderData())==null?void 0:o.title:r?await this.getRawTitleData():void 0;let n=s==null?void 0:s.chapters;if(!e&&!r&&(n=await this.getChapters((c=this.spec.chapters)==null?void 0:c.chapter,{lazy:(u=this.spec.chapters)==null?void 0:u.lazy})),!n)return;const i=(g=this.context)==null?void 0:g.lang,l=i?n.filter(d=>!d.lang||d.lang===i):n;return{chapters:l,title:s?{...s,chapters:[]}:await this.getTitleData((h=this.spec.chapters)==null?void 0:h.title),hasMore:!1,asc:!1,total:l.length}}async getRawSearchData(){var s;const t=(s=this.spec.search)==null?void 0:s.title;if(!t)return;const{chapter:e}=t,r=[];return await Promise.all(Array.from(document.querySelectorAll(t.sel)).map(async n=>{const i=p(t.url,n),l=C(i),o=p(t.name,n),{slug:c,id:u}=this.parseTitleSlug(l);!l||!o||!c||r.push({id:u,slug:c,name:o,chapters:await this.getChapters(e,{root:n,titleId:u,titleSlug:c})??[]})})),r.length?{rawReleases:r}:void 0}async getChapters(t,{root:e=document.documentElement,titleId:r="",titleSlug:s="",includeHiddenChapters:n=!1,lazy:i=!0,timeoutMs:l}){var f;if(!t)return;let o=null;if(t.trigger){if(!n||(o=document.querySelector(t.trigger),!o))return;o.click()}const c=[],u=await L(t.sel,{root:e,all:!0,lazy:i,timeoutMs:l});if(!(u!=null&&u.length))return o==null||o.click(),[];const g=(u??[]).map((m,y)=>({id:p(t.id,m),label:p(t.label,m),url:p(t.url,m),at:p(t.at,m),elIndex:y}));o==null||o.click();const h=g.map(({label:m})=>A(m)),d=(f=h[1])==null?void 0:f.chap;!h[0]&&(d===void 0||d<=1)&&(h[0]={chap:0});const{readerBase:v}=this.siteMeta,b=ot(v,{titleId:r,titleSlug:s});return h.forEach((m,y)=>{if(!m)return;const{id:P,url:R,at:B,elIndex:T}=g[y],D={...m,id:P,elIndex:T,ts:it(B,this.siteMeta.defaultLang)},w=(R==null?void 0:R.startsWith("http"))&&!R.includes(`//${location.hostname}/`),S=w?R:C(R);if(!S){c.push(D);return}if(w){c.push({...D,slug:S});return}const{slug:$,lang:N}=this.parseReaderSlug(b,S,R);c.push({...D,slug:$,lang:N})}),U(c)}static async isReaderPage(t){return!!t.sel&&!!await L(t.sel,{lazy:!!t.lazy})}static async verifyImgsCotainer(t){const e=t.split(",").map(r=>r.trim()).filter(Boolean).map(r=>`${r} img, ${r} canvas`).join(",");return!!await L(e,{lazy:!0,all:!1})}findNeighborChapter({sel:t,basePath:e}){const r=p(t);if(!r||r.startsWith("#")||r.startsWith("/#"))return;const s=C(r);if(s)return this.parseReaderSlug(e,s,r).slug}finalizeRawReaderData(t,{prevSlug:e,nextSlug:r}={}){var c;const s=(c=t.title)==null?void 0:c.chapters;if(!(s!=null&&s.length)){const u=A(e),g=A(r);return!u&&!g?t:{...t,prev:u?{...u,slug:e}:void 0,next:g?{...g,slug:r}:void 0}}let n,i,l,o;for(let u=0;u<s.length&&!(n&&(!e||l)&&!r&&o);u++){const g=s[u];!n&&(t.slug==g.slug||t.chap===g.chap&&(t.vol===g.vol||t.vol===void 0))?(n=g,i=u):!l&&e===g.slug?l=g:!o&&r===g.slug&&(o=g)}return i!==void 0&&(l??(l=s[i+1]),o??(o=s[i-1])),{...t,inferVol:n==null?void 0:n.inferVol,prev:l,next:o}}}var oe=Object.defineProperty,ce=(a,t,e)=>t in a?oe(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,ue=(a,t,e)=>(ce(a,typeof t!="symbol"?t+"":t,e),e);class Rt extends x{parseTitleSlug(t){var e;return{slug:(e=C(t))==null?void 0:e.split("/").filter(Boolean)[1]}}}ue(Rt,"specId","bato");function ge(){return Math.random().toString(16).slice(2)}async function he({addListener:a,removeListener:t,transform:e,filter:r,handler:s,onTimeout:n,timeout:i,once:l}){return new Promise(o=>{a(g);const c=()=>l===!0&&t(g),u=i?setTimeout(()=>{c(),o(void 0),n==null||n()},i):void 0;async function g(h,...d){h=e?e(h):h,h!==void 0&&(!r||r(h,...d))&&(c(),o(h),s==null||s(h,...d),u&&clearTimeout(u))}})}async function pe(a){var t;return(t=await he({addListener:e=>window.addEventListener("message",e),removeListener:e=>window.removeEventListener("message",e),...a}))==null?void 0:t.data}async function de(a){var l,o;const{receiverWindow:t,timeout:e,targetOrigin:r,event:s,args:n}=a,i={reqId:ge(),event:s,args:n};return(l=t||window)==null||l.postMessage(i,r??"*"),(o=await pe({filter:c=>{var u;return((u=c==null?void 0:c.data)==null?void 0:u.resId)===i.reqId},timeout:e??3e4,once:!0}))==null?void 0:o.result}const z={isAny:!0};function _(a,...t){return de({event:"tk:fetchResult",args:{baseUrl:a,segments:t}})}var fe=Object.defineProperty,me=(a,t,e)=>t in a?fe(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,we=(a,t,e)=>(me(a,typeof t!="symbol"?t+"":t,e),e);const xt=class St extends x{async getRawReleasesData(){let t;try{const r=Array.from({length:2},async(s,n)=>{const i=`https://api.${location.host}/chapter?accept_erotic_content=true&page=${n+1}&order=new`;return(await fetch(i)).json()});t=(await Promise.all(r)).flat()}catch{return}const e=[];return t.forEach(r=>{const{vol:s,chap:n,hid:i,lang:l,updated_at:o,md_comics:c}=r,u=typeof n=="string"&&!isNaN(+n)?+n:void 0;typeof u=="number"&&e.push({id:c.hid,slug:c.slug,name:c.title,chapters:[{slug:i,vol:typeof s=="string"&&!isNaN(+s)?+s:void 0,chap:u,lang:l,ts:new Date(o).valueOf()}]})}),super.finalizeRawReleasesData({rawReleases:e})}async getRawTitleData(){var l,o,c,u,g;const t=await super.getRawTitleData();if(!t)return t;const e=await _(`https://api.${location.host}`,"comic",z,"chapters");if(!e)return t;const r=e.url.split("/").filter(Boolean).slice(-2)[0],s=ct(e.value),n=p("h1 ~ div.text-sm span:first-child|row:demographic"),i=n?(l=this.getTagIdsFromNames([n]))==null?void 0:l[0]:void 0;return i&&!((o=t.tags)!=null&&o.includes(i))&&((c=t.tags)==null||c.push(i),(u=t.tags)==null||u.sort((h,d)=>h-d)),{...t,img:t.img??bt(p((g=this.spec.title)==null?void 0:g.img)),id:r,hasMoreChapters:(s==null?void 0:s.hasMore)??!1,chapters:(s==null?void 0:s.chapters)??[]}}async getRawReaderData(){var e;const t=await super.getRawReaderData();return t&&{...t,lang:t.lang&&((e=t.lang)==null?void 0:e.length)<=6?t.lang:St.getLangFromReaderSlug(t.slug)||t.lang}}static getLangFromReaderSlug(t){const e=t.split("-");let r;for(let s=e.length-1;s>0;s--){const n=e[s];if(!isNaN(+n))break;r=r?`${n}-${r}`:n}return r&&r.length<=6?r:void 0}async getRawChaptersData(){var n;if(!((n=this.context)!=null&&n.rawId))return;const{rawId:t,lang:e="en",skip:r}=this.context,s=r?Math.floor(r/1e3)+1:void 0;try{const i=await fetch(`https://api.${location.host}/comic/${t}/chapters?lang=${e}&limit=1000${s&&s>1?`&page=${s}`:""}`),l=ct(await i.json());return l?{...l,lang:e,asc:!1}:void 0}catch{return}}};we(xt,"specId","comick");let ye=xt;function ct(a){if(!Array.isArray(a==null?void 0:a.chapters))return;const t=[];return a.chapters.forEach(e=>{const{vol:r,chap:s,hid:n,lang:i,updated_at:l}=e,o=typeof s=="string"&&!isNaN(+s)?+s:void 0;typeof o!="number"||t.some(c=>c.vol==r&&c.chap===o&&c.lang===i)||t.push({slug:n,vol:typeof r=="string"&&!isNaN(+r)?+r:void 0,chap:o,lang:i,ts:new Date(l).valueOf()})}),{chapters:U(t),total:a.total??t.length,hasMore:a.total>a.limit}}function Dt(a,t){const e=a[0]===t?a.substring(1):a;return e[e.length-1]===t?e.substring(0,e.length-1):e}var ve=Object.defineProperty,be=(a,t,e)=>t in a?ve(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,Re=(a,t,e)=>(be(a,typeof t!="symbol"?t+"":t,e),e);class Z extends x{async getRawReleasesData(){const t=this.detectNewSiteMeta(this.spec.releases,this.siteMeta);this.siteMeta=t??this.siteMeta;const e=await super.getRawReleasesData();if(e)return{...e,siteMeta:t}}async getRawTitleData(){const t=this.finalizeNewSiteMeta(this.siteMeta,{titleBase:this.extractBasePath(location.pathname)});this.siteMeta=t??this.siteMeta;const e=await super.getRawTitleData();if(e)return{...e,siteMeta:t}}async getRawReaderData(){var s;const t=ut((s=this.spec.reader)==null?void 0:s.title);if(!t)return;const e=this.finalizeNewSiteMeta(this.siteMeta,{titleBase:this.extractBasePath(C(t))});this.siteMeta=e??this.siteMeta;const r=await super.getRawReaderData();if(r)return{...r,siteMeta:e}}async getRawSearchData(){var s;const t=ut((s=this.spec.search)==null?void 0:s.title);if(!t)return;const e=this.finalizeNewSiteMeta(this.siteMeta,{titleBase:this.extractBasePath(C(t))});this.siteMeta=e??this.siteMeta;const r=await super.getRawSearchData();if(r)return{...r,siteMeta:e}}detectNewSiteMeta(t,e){if(!t)return;const r=t.title,s=document.querySelector(r.sel)??void 0;if(!s)return;const n=C(p(r.url,s));if(n!==void 0)return this.finalizeNewSiteMeta(e,{titleBase:this.extractBasePath(n)})}finalizeNewSiteMeta(t,{titleBase:e}){if(t.titleBase!==e)return{...t,titleBase:e,readerBase:t.readerBase.replace(t.titleBase,e)}}extractBasePath(t){return Dt(t,"/").split("/").slice(0,-1).join("/")}}Re(Z,"specId","madara");function ut(a){if(!a)return;const t=document.querySelector(a.sel);return p(a.url,t)}var xe=Object.defineProperty,Se=(a,t,e)=>t in a?xe(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,De=(a,t,e)=>(Se(a,typeof t!="symbol"?t+"":t,e),e);class Mt extends x{async getRawReleasesData(){const t=await this.getVM();if(!t)return super.getRawReleasesData();const e=t.LatestJSON.slice(0,100).map(r=>{const s=r.IndexName;return{slug:s,name:r.SeriesName,chapters:[Y(r,s)]}});return this.finalizeRawReleasesData({rawReleases:e})}parseTitleSlug(t){const{slug:e}=super.parseTitleSlug(t);return!e||e.includes("{")?{}:{slug:e}}async getRawTitleData(){const t=await super.getRawTitleData();return t&&{...t,chapters:gt(await this.getVM(),t.slug),hasMoreChapters:!1}}parseReaderSlug(t,e){const{slug:r,basePath:s}=super.parseReaderSlug(t,e);return{slug:r.replace(/-page-\d{1,3}\.html\/?$/,".html"),basePath:s}}async getRawReaderData(){var n;const t=await this.getVM();if(!t)return;const e=(n=document.querySelector(".ImageGallery img.img-fluid"))==null?void 0:n.getAttribute("ng-src"),r=t.IndexName,s=Y(t.CurChapter,r);return this.finalizeRawReaderData({chap:s.chap,slug:s.slug,imgs:Ce(t,e??void 0),basePath:"/"+this.siteMeta.readerBase.replace("{titleSlug}",r)+"/",title:{name:t.SeriesName,slug:r,url:`/${this.siteMeta.titleBase}/${r}`,chapters:gt(t,r),hasMoreChapters:!1}})}getVM(){return W(50,100,()=>{var t,e,r,s;return(s=(r=(e=(t=window.angular)==null?void 0:t.element)==null?void 0:e.call(t,document.documentElement))==null?void 0:r.scope())==null?void 0:s.vm})}}De(Mt,"specId","manga4life");function gt(a,t){return((a==null?void 0:a.Chapters)??(a==null?void 0:a.CHAPTERS)??[]).sort((e,r)=>r.Chapter-e.Chapter).map(e=>Y(e,t))}function Y(a,t){const e=+a.Chapter[0],r=+a.Chapter.substring(1)/10;return{slug:`${t}-chapter-${r}${e&&e>1?`-index-${e}`:""}.html`,chap:r,ts:Me(a.Date)}}function Me(a){const t=new Date(a).valueOf();return t===t?t:void 0}function Ce(a,t){let e=(t==null?void 0:t.split(".").slice(-1)[0])??"png";e=e.length>=3&&e.length<=4?e:"png";try{const r=a.CurChapter.Chapter.slice(1,-1),s=a.CurChapter.Chapter[a.CurChapter.Chapter.length-1],n=s!=="0"?`${r}.${s}`:r,i=`https://${a.CurPathName}/manga/${a.IndexName}/${a.CurChapter.Directory?`${a.CurChapter.Directory}/`:""}${n}-`;return a.Pages.map(l=>{const o=(l+"").padStart(3,"0");return`${i}${o}.${e}`})}catch{return}}var Ie=Object.defineProperty,Pe=(a,t,e)=>t in a?Ie(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,$e=(a,t,e)=>(Pe(a,typeof t!="symbol"?t+"":t,e),e);const Te={a:.1,b:.2,c:.3,d:.4};class Ct extends V{parseTitleSlug(t){var e;return{slug:(e=C(t))==null?void 0:e.split("/").filter(Boolean)[1]}}async getRawReleasesData(){let t=[];try{t=(await(await fetch("https://api.mangadex.org/chapter?limit=96&offset=0&includes[]=manga&contentRating[]=safe&contentRating[]=suggestive&contentRating[]=erotica&contentRating[]=pornographic&order[readableAt]=desc")).json()).data}catch{return}const e=[];return t.forEach(({relationships:r,attributes:s,id:n})=>{const i=r.find(({type:c})=>c==="manga"),l=j(s.volume),o=j(s.chapter);o!==void 0&&e.push({slug:i.id,name:Object.values(i.attributes.title)[0],chapters:[{slug:s.externalUrl||n,vol:l,chap:o,lang:s.translatedLanguage,ts:new Date(s.readableAt).valueOf()}]})}),super.finalizeRawReleasesData({rawReleases:e})}async getRawTitleData(){var l,o;const t="https://api.mangadex.org/manga/",[e,r]=await Promise.all([_(t,z),_(t,z,"feed")]);if(!e||!r)return;const s=((o=(l=r.value.data)==null?void 0:l.map)==null?void 0:o.call(l,c=>{const{attributes:u,id:g}=c;if(typeof u!="object"||typeof g!="string"||!g)return;const{externalUrl:h,title:d,volume:v,chapter:b,translatedLanguage:f}=u;return{slug:h||g,label:d||void 0,vol:j(v),chap:j(b),lang:f||"en",ts:new Date(u.readableAt).valueOf()}}).filter(c=>(c==null?void 0:c.chap)!=null))??[],{data:n}=e.value;if(!n)return;const i=pt({data:n,getTagIdsFromNames:c=>this.getTagIdsFromNames(c)});if(i)return{...i,chapters:U(s),hasMoreChapters:(r.value.total||0)>(r.value.limit||0)}}async getRawReaderData(){var D,w,S,$,N,k,K,Q,X,tt,et,at,rt;const t="https://api.mangadex.org/",[e,r,s]=await Promise.all([_(t,"chapter",z),_(t,"at-home","server",z),_(t,"manga",z,"aggregate")]);if(!e||!r||!s)return;const n=e.value.data,{volume:i,chapter:l,externalUrl:o,translatedLanguage:c}=n.attributes||{},{baseUrl:u,chapter:{data:g,dataSaver:h,hash:d}}=r.value,v=(w=(D=n.relationships)==null?void 0:D.find)==null?void 0:w.call(D,I=>I.type==="manga");if(!v)return;const b=pt({data:v,getTagIdsFromNames:I=>this.getTagIdsFromNames(I)});if(!b||typeof s.value.volumes!="object")return;const f=ht(s.value)??[];(typeof l!="string"||l==="none")&&!f.length&&f.push({chap:0,slug:n.id});const m=f.findIndex(I=>I.slug===n.id),y=($=(S=n.relationships)==null?void 0:S.find)==null?void 0:$.call(S,I=>I.type==="scanlation_group"),P=u.endsWith("/")?u:u+"/",R=!!((k=(N=localStorage.getItem("md"))==null?void 0:N.includes)!=null&&k.call(N,'"dataSaver":true')),B=`${P}${R?"data-saver":"data"}/`,T=((Q=(K=(R?h:g)??[]).map)==null?void 0:Q.call(K,I=>`${B}${d}/${I}`))??[];return{externalUrl:o,vol:j(i),inferVol:(X=f[m])==null?void 0:X.inferVol,chap:j(l)||0,imgs:T,lang:c,slug:n.id,prev:f[m+1],next:f[m-1],basePath:"/chapter/",groupName:(tt=y==null?void 0:y.attributes)==null?void 0:tt.name,groupUrl:(et=y==null?void 0:y.attributes)==null?void 0:et.website,isWebtoon:(rt=(at=v==null?void 0:v.attributes)==null?void 0:at.tags)==null?void 0:rt.some(I=>I.attributes.name.en==="Long Strip"),title:{...b,chapters:f}}}async getRawChaptersData(){if(!this.context)return;const{titleSlug:t,lang:e="en"}=this.context;let r;try{const s=await fetch(`https://api.mangadex.org/manga/${t}/aggregate?translatedLanguage[]=${e}`);r=ht(await s.json())}catch{return}if(r)return{chapters:r,lang:e,asc:!1,hasMore:!1,total:r.length}}}$e(Ct,"specId","mangadex");function j(a){if(typeof a!="string"||a==="none")return;const t=parseFloat(a);if(t!==t)return;const e=a[a.length-1];return t+(Te[e]??0)}function ht(a){if(typeof a.volumes!="object")return;const t=Object.values(a.volumes).map(({volume:e,chapters:r})=>{const s=j(e);return Object.values(r).map(({id:n,chapter:i})=>{const l=j(i);if(l!==void 0)return{vol:s,chap:l,slug:n}})}).flat().filter(Boolean).reverse();return U(t)}function pt({data:a,getTagIdsFromNames:t}){var y,P,R,B,T,D;const{id:e,attributes:r,relationships:s}=a;if(!e||typeof e!="string"||typeof r!="object")return;const{title:n,availableTranslatedLanguages:i,altTitles:l,tags:o,contentRating:c}=r;if(typeof n!="object"||i&&!Array.isArray(i))return;const u=Object.values(n)[0];if(!u||typeof u!="string")return;const g=Ne(),h=((P=(y=i??[])==null?void 0:y.map)==null?void 0:P.call(y,w=>typeof w=="string"?w:void 0).filter(Boolean))??[],d=h.filter(w=>w&&(!g||g.includes(w))),v=(R=l==null?void 0:l.map)==null?void 0:R.call(l,w=>{const[[,S]=[]]=Object.entries(w);return S}),b=(D=(T=(B=s==null?void 0:s.find)==null?void 0:B.call(s,w=>w.type==="cover_art"))==null?void 0:T.attributes)==null?void 0:D.fileName,f=b?`https://uploads.mangadex.org/covers/${e}/${b}.256.jpg`:void 0,m=(o||[]).map(w=>{var S,$;return($=(S=w==null?void 0:w.attributes)==null?void 0:S.name)==null?void 0:$.en}).concat(c).filter(Boolean);return{url:`${location.origin}/title/${e}`,slug:e,name:u,altNames:v,langs:d.length>0?d:h.length>0?h:["en"],img:f,tags:t(m)}}function Ne(){var t,e;const a=localStorage.getItem("md");if(a)try{const r=(e=(t=JSON.parse(a))==null?void 0:t.userPreferences)==null?void 0:e.filteredLanguages;return r!=null&&r.length?r:void 0}catch{return}}var Be=Object.defineProperty,Oe=(a,t,e)=>t in a?Be(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,je=(a,t,e)=>(Oe(a,typeof t!="symbol"?t+"":t,e),e);class It extends x{async getRawReleasesData(){const t=await super.getRawReleasesData();if(t)return{...t,rawReleases:t.rawReleases.map(e=>{var r;return{...e,id:(r=e.id)==null?void 0:r.split("?")[0]}})}}async getRawReaderData(){var t,e;if(((e=(t=await L(".current-viewtype",{lazy:!0,all:!1}))==null?void 0:t.textContent)==null?void 0:e.trim().toLowerCase())!=="volume")return await super.getRawReaderData()}async getRawChaptersData(){var r;const t=(r=this.context)==null?void 0:r.lang;if(!t)return;const e=await L(`.tab-content[data-name="chapter"] a.dropdown-item[data-code="${t.toUpperCase()}"]`,{lazy:!0,all:!1});if(e)return e.click(),await L(`.tab-content[data-name="chapter"] li.item[data-number] a[href*="/${t}/"]`,{lazy:!0,all:!1}),await super.getRawChaptersData()}}je(It,"specId","mangafire");var Le=Object.defineProperty,_e=(a,t,e)=>t in a?Le(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,ze=(a,t,e)=>(_e(a,typeof t!="symbol"?t+"":t,e),e);class Pt extends x{async getRawReaderData(){const t=await super.getRawReaderData();return t&&{...t,imgs:await this.getImgs()}}parseReaderSlug(t,e){const{slug:r,basePath:s}=super.parseReaderSlug(t,e),n=r.split("/").filter(Boolean),i=n[n.length-1];return{basePath:s,slug:i.startsWith("pg-")?n.slice(0,-1).join("/"):r}}async getImgs(){const t=await W(100,20,()=>window.imgsrcs),e=window.CryptoJS,r=e.enc.Hex.parse("e11adc3949ba59abbe56e057f20f883e"),s={iv:e.enc.Hex.parse("1234567890abcdef1234567890abcdef"),padding:e.pad.ZeroPadding};return e.AES.decrypt(t,r,s).toString(e.enc.Utf8).split(",")}}ze(Pt,"specId","mangago");var Ae=Object.defineProperty,Ee=(a,t,e)=>t in a?Ae(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,We=(a,t,e)=>(Ee(a,typeof t!="symbol"?t+"":t,e),e);class $t extends x{async getRawTitleData(){const t=await super.getRawTitleData();return t&&{...t,chapters:t.chapters.map(e=>{var r;return{...e,slug:(r=e.slug)==null?void 0:r.split("/").filter(Boolean).slice(-1)[0]}})}}}We($t,"specId","mangaplus");var ke=Object.defineProperty,qe=(a,t,e)=>t in a?ke(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,Ue=(a,t,e)=>(qe(a,typeof t!="symbol"?t+"":t,e),e);class Tt extends x{async getRawReleasesData(){const t=await super.getRawReleasesData();if(t)return{...t,rawReleases:t.rawReleases.map(e=>({...e,id:e.slug.substring(e.slug.lastIndexOf("-")+1)||void 0}))}}}Ue(Tt,"specId","mangareader");var Fe=Object.defineProperty,Ve=(a,t,e)=>t in a?Fe(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,He=(a,t,e)=>(Ve(a,typeof t!="symbol"?t+"":t,e),e);class Nt extends Z{async getRawReaderData(){const t=await super.getRawReaderData();if(t)return{...t,title:{...t.title,id:await this.getReaderTitleId()}}}async getReaderTitleId(){var s,n;const t=await((n=(s=window.HISTORY)==null?void 0:s.getStored)==null?void 0:n.call(s));if(!t||typeof t!="object")return;const e=Object.values(t).filter(Boolean);if(!e.length)return;e.sort((i,l)=>l.time-i.time);const r=e[0].manga_ID;return typeof r=="string"?r:typeof r=="number"?r+"":void 0}detectNewSiteMeta(t,e){if(!t)return;const r={...e,releases:Dt(location.pathname,"/")},s=t.title,n=document.querySelector(s.sel)??void 0;if(!n)return;const i=C(p(s.url,n));if(i===void 0)return;const l=n.querySelector(s.chapter.sel)??void 0;if(!(!l||C(p(s.chapter.url,l))===void 0))return r.titleBase=this.extractBasePath(i),e.titleIdType===J.id&&(p(s.id,n)||(e.titleIdType=J.name)),this.finalizeNewSiteMeta(e,r)}finalizeNewSiteMeta(t,e){const r=Object.keys(e),s={...t};let n=!1;return r.forEach(i=>{const l=e[i];l!==t[i]&&(s[i]=l,n=!0)}),n?s:void 0}}He(Nt,"specId","mangastream");var Je=Object.defineProperty,Ge=(a,t,e)=>t in a?Je(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,Ye=(a,t,e)=>(Ge(a,typeof t!="symbol"?t+"":t,e),e);class Bt extends x{async getRawReaderData(){const t=await super.getRawReaderData();if(t)return{...t,title:{...t.title,name:t.title.name.replace("Ritorna a","").trim()}}}}Ye(Bt,"specId","mangaworld");var Ze=Object.defineProperty,Ke=(a,t,e)=>t in a?Ze(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,Qe=(a,t,e)=>(Ke(a,typeof t!="symbol"?t+"":t,e),e);class Ot extends x{async getRawTitleData(){const t=await super.getRawTitleData();if(t)return{...t,hasMoreChapters:t.chapters.length===50}}}Qe(Ot,"specId","mgeko");var Xe=Object.defineProperty,ta=(a,t,e)=>t in a?Xe(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,ea=(a,t,e)=>(ta(a,typeof t!="symbol"?t+"":t,e),e);class jt extends x{async getRawTitleData(){const t=await super.getRawTitleData();if(!t)return t;const e=await _(`https://api.${location.host}`,"chapter","query");if(!e)return;let r;try{r=new URL(e.url).searchParams.get("series_id")}catch{return}if(!r)return;const{first_page:s,last_page:n}=e.value.meta||{};return{...t,id:r,hasMoreChapters:s!==n}}async getRawChaptersData(){var e,r;if(!((e=this.context)!=null&&e.rawId))return;const{rawId:t}=this.context;try{const s=await(await fetch(`https://api.${location.host}/chapter/query?page=1&perPage=1000&query=&order=desc&series_id=${t}`)).json();if(!((r=s==null?void 0:s.data)!=null&&r.map))return;const n=[];return s.data.forEach(i=>{const{chapter_name:l,chapter_slug:o,created_at:c}=i;if(typeof l!="string"||typeof o!="string")return;const u=A(l);if(u!=null&&u.chap)return{...u,slug:o,ts:c&&new Date(c).valueOf()||void 0}}),{chapters:n,hasMore:!1,asc:!1}}catch{return}}}ea(jt,"specId","reaper");var aa=Object.defineProperty,ra=(a,t,e)=>t in a?aa(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,sa=(a,t,e)=>(ra(a,typeof t!="symbol"?t+"":t,e),e);class Lt extends x{async getRawTitleData(){var r;const t=await super.getRawTitleData();if(!t)return;const e=(r=q(".info-detail__row > .genre-btn,.info__right .stats__row:first-child|text"))==null?void 0:r.map(s=>[s,...s.split(" ")]).flat();return dt({...t,tags:this.getTagIdsFromNames(e)??[]},".episode-header .episode-cnt")}async getRawReaderData(){const t=await super.getRawReaderData();if(!t)return;const e=`${location.origin}/series/${t.title.slug}/info`;return{...t,title:{...dt({...t.title,url:e,tags:[]},".episode-list .js-ep-cnt"),hasMoreChapters:!1}}}async getRawChaptersData(){if(!this.context)return;const{rawId:t,skip:e}=this.context,r=1e3,s=e?Math.floor(e/1e3)+1:1;try{const n=await fetch(`/series/${t}/episodes?page=${s}&sort=NEWEST&max_limit=${r}`);return na(await n.json())}catch{return}}parseTitleSlug(t){if(!t)return{};const e=t.split("/").filter(Boolean);return{slug:e[1]??e[0]}}}sa(Lt,"specId","tapas");function dt(a,t){const e=ia(t)>20;return{...a,chapters:e?[]:a.chapters,hasMoreChapters:e}}function na(a){var s,n;const t=(s=a==null?void 0:a.data)==null?void 0:s.episodes;if(!Array.isArray(t))return;const e=t.map(i=>{var l,o;return{chap:i.pending_scene??i.scene,slug:i.id+"",ts:((o=(l=new Date(i.publish_date))==null?void 0:l.valueOf)==null?void 0:o.call(l))||void 0}}),r=(n=a==null?void 0:a.data)==null?void 0:n.pagination;return{chapters:e,total:(r==null?void 0:r.total)??e.length,hasMore:!!(r!=null&&r.has_next)}}function ia(a){var t,e;return+(((e=(t=document.querySelector(a))==null?void 0:t.textContent)==null?void 0:e.trim().split(" ")[0])||0)}var la=Object.defineProperty,oa=(a,t,e)=>t in a?la(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,ca=(a,t,e)=>(oa(a,typeof t!="symbol"?t+"":t,e),e);class _t extends x{async getRawTitleData(){var i;const t=new URLSearchParams(location.search),e=t.get("episode_no"),r=t.get("title_no");if(e||!r)return;const s=await super.getRawTitleData();if(!s)return;const n=location.pathname.split("/")[1];return{...s,slug:`${s.slug}?title_no=${r}`,id:r,langs:[n].filter(Boolean),chapters:s.chapters.map(l=>({...l,lang:n})),hasMoreChapters:(((i=document.querySelector(".paginate"))==null?void 0:i.childElementCount)??1)>1}}async getRawReaderData(){var g;const t=new URLSearchParams(location.search),e=t.get("episode_no"),r=t.get("title_no");if(!e||!r)return;const s=A(p(".paginate > span:not(:first-child)|text"));if(s===void 0)return;const{chap:n}=s,i=(g=document.title.split("|")[1])==null?void 0:g.trim();if(!i)return;const l=location.pathname.split("/"),o=`${l.slice(0,4).join("/")}/list?title_no=${r}`,c=await this.getChapters({sel:"#sequence_scroll li.eg-flick-panel,#toolbar .episode_lst li[data-episode-no]",url:"a|attr:href",label:"|attr:data-episode-no || .num|text"},{lazy:!1,titleId:r,titleSlug:o}),u=l[1];return{chap:n,lang:u,slug:`${location.pathname}?title_no=${r}&episode_no=${e}`,basePath:"",imgs:await this.getReaderImgs(),isWebtoon:!0,title:{id:r,url:o,slug:o,name:i,langs:[u],chapters:(c??[]).map(h=>({...h,lang:u})),hasMoreChapters:!1}}}async getReaderImgs(){const t=q("#_imageList img|[attr:data-url,attr:src]");return t!=null&&t.length?t:await W(100,50,()=>{var e,r,s;return(s=(r=(e=window.__viewerState__)==null?void 0:e.scrollViewerParam)==null?void 0:r.imageList)==null?void 0:s.map(({url:n})=>n).filter(Boolean)})}parseReaderSlug(t,e,r){if(!r)return{basePath:"",slug:e};if(r.startsWith("http://")||r.startsWith("https://")){const s=H(r);return{basePath:"",slug:s.pathname+s.search}}return{basePath:"",slug:r}}}ca(_t,"specId","webtoon");const ua=[Rt,ye,Z,Mt,Ct,It,Pt,$t,Tt,Nt,Bt,Ot,jt,Lt,_t];function ft(a){const t=ua.find(e=>e.specId===a.spec.id)??x;return new t(a)}async function ga(a){const{spec:t}=a;if(t){const e=a.siteMeta??t.meta,r=a.type?[a.type]:mt(e,t.generic);if(!r.length)return;const s=ft({...a,spec:t,siteMeta:e});return await st(r.map(n=>s.getRawPageByType(n,r.length>1)))}return await st((a.genericSpecs??[]).map(e=>{const r=mt(e.meta,e.generic);if(!r.length)return[];const s=ft({...a,spec:e,siteMeta:e.meta});return r.map(n=>s.getRawPageByType(n,!0))}).flat())}function mt(a,t){if(location.pathname==="/")return[];const{titleBase:e,readerBase:r}=a,s=location.pathname.split("/").filter(Boolean),n=wt(s,r),i=wt(s,e);if(n&&i)return[M.reader,M.title];const l=[];return n!==!1&&!i&&l.push(M.reader),i!==!1&&!n&&l.push(M.title),!l.length&&t?[M.reader,M.title]:l}function wt(a,t){if(!t)return;const e=t.split("/").filter(Boolean),r=e.indexOf("{slug}"),s=r===e.length-1,n=!s&&r!==-1;if(s&&(e.pop(),!e.length))return;const i=a.length-e.length;if(n?i<0:i<=0)return!1;let l=!1;for(let o=0;o<e.length;o++){const c=e[o];if(c[0]!=="{"){if(c!==a[o])return!1;l=!0}}if(l&&i===(n?0:1))return!0}export{M as S,ga as t};
